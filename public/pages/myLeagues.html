<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Leagues</title>
    <link rel="stylesheet" href="../styles/create_modify_event.css" />
    <link rel="stylesheet" href="../styles/leaguecard.css" />
    <link rel="stylesheet" href="../styles/navbar.css" />
    <link rel="stylesheet" href="../styles/leagues.css" />
  </head>

  <body>
    <nav class="navbar">
      <div class="nav-logo">
        <img src="../assets/icons/icon_logo.svg" />
        <span>BeyondSports</span>
      </div>
      <div class="nav-search">
        <input type="text" placeholder="Search for anything" />
      </div>
      <ul class="nav-links">
        <li><a href="#">Home</a></li>
        <li><a href="#">My Events</a></li>
        <li><a href="#">My Leagues</a></li>
        <li><a href="#">Contacts</a></li>
      </ul>
      <div class="nav-create">
        <button class="dropbtn">Create</button>
        <div class="dropdown-content">
          <a href="#">Event</a>
          <a href="#">League</a>
        </div>
      </div>
    </nav>

    <h1>Your Confirmed Leagues:</h1>
    <main class="leagues-opened-container">
      <section class="leagues-header">
        <!-- <div class="leagues-image">
          <img src="../assets/images/league2.png" alt="Basketball Game" />
          <div class="text-overlay">
            <h2 class="league-title">Hoopers League</h2>
            <p class="league-date">April 9-11</p>
          </div>
        </div> -->
      </section>
    </main>
    <h1>Pending Leagues:</h1>
    <main class="pending-leagues-container">
      <section class="leagues-header">
        <!-- <div class="leagues-image">
          <img src="../assets/images/league1.png" alt="Basketball Game" />
          <div class="text-overlay">
            <h2 class="league-title">PowerUp League</h2>
            <p class="league-date">April 7-16</p>
          </div>
        </div> -->
      </section>
    </main>
  </body>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const userId = 1; // Assuming the user's ID is stored in local storage
      if (!userId) {
        console.error("User ID is required.");
        return;
      }

      fetch(`/leagues/user/${userId}`)
        .then((response) => response.json())
        .then((data) => updateLeaguesDisplay(data))
        .catch((error) => console.error("Failed to fetch leagues:", error));
    });

    function updateLeaguesDisplay(leagues) {
      const confirmedContainer = document.querySelector(
        ".leagues-opened-container"
      );
      const pendingContainer = document.querySelector(
        ".pending-leagues-container"
      ); // You may need to add this to your HTML

      leagues.forEach((league) => {
        const leagueHtml = `
          <div class="league-card">
            <img src="${
              league.imageUrl || "../assets/images/default_league.png"
            }" alt="${league.leagueName}" />
            <div class="league-info">
              <h3>${league.leagueName}</h3>
              <p>${league.eventDates}</p>
            </div>
          </div>  
        `;

        if (league.type === "participant") {
          confirmedContainer.insertAdjacentHTML("beforeend", leagueHtml);
        } else if (league.type === "pending") {
          pendingContainer.insertAdjacentHTML("beforeend", leagueHtml);
        }
      });
    }
  </script>
</html>
